<p>Имея систему линейных уравнений с целыми коэффициентами, естественно задаться вопросом, каковы ее целочисленные решения. Мы уже видели, что это не вполне тривиальный вопрос даже для одного линейного уравнения.</p>

<p>До сих пор мы пользовались следующим соображением: система линейных уравнений <span class="math-tex">\(Ax=b\)</span> равносильна системе <span class="math-tex">\(C\!Ax=Cb\)</span> для любой обратимой матрицы <span class="math-tex">\(C\)</span>. Теперь добавим еще одно: система <span class="math-tex">\(Ax=b\)</span> эквивалентна системе <span class="math-tex">\(ACC^{-1}x=b\)</span> для любой обратимой матрицы <span class="math-tex">\(C\)</span>. Объединяя эти два наблюдения, получаем следующий подход:</p>

<ol>
	<li>Найти такие обратимые матрицы <span class="math-tex">\(C_1\)</span> и <span class="math-tex">\(C_2\)</span>, что для матрицы <span class="math-tex">\(D=C_1AC_2\)</span> система уравнений <span class="math-tex">\(Dy=C_1b\)</span> решается (каким-нибудь образом);</li>
	<li>Вектор <span class="math-tex">\(x=C_2y\)</span> является решением <span class="math-tex">\(Ax=b\)</span> для любого <span class="math-tex">\(y\)</span>, дающего решение СЛУ выше.</li>
</ol>

<p>Если матрицы <span class="math-tex">\(C_1\)</span> и <span class="math-tex">\(C_2\)</span> обратимы над целыми числами и <span class="math-tex">\(y\)</span> пробегает множестве целочисленных решений новой системы, то <span class="math-tex">\(x\)</span> пробегает множество всех целочисленных решений исходной системы. Остается только вопрос, как найти подходящие <span class="math-tex">\(C_1\)</span> и <span class="math-tex">\(C_2\)</span>.</p>

<p>Ответ дается понятием нормальной формы Смита. А именно, существует последовательность элементарных строчных и столбцовых преобразований с целыми коэффициентами (и как следствие, целочисленные обратимые над <span class="math-tex">\(\mathbb{Z}\)</span> матрицы <span class="math-tex">\(C_1\)</span> и <span class="math-tex">\(C_2\)</span>), приводящих исходную матрицу <span class="math-tex">\(A\)</span> к виду <span class="math-tex">\[D = C_1AC_2 = \left( \begin{array}{cccc|c} d_1 \\ &amp; d_2 \\ &amp;&amp; \ddots &amp;&amp; 0 \\ &amp;&amp;&amp; d_s \\\hline &amp;&amp; 0 &amp;&amp; 0 \end{array} \right),\]</span>где <span class="math-tex">\(d_i\in\mathbb{Z}\)</span> и <span class="math-tex">\(d_i \mid d_{i+1}\)</span>. Для наших целей будет достаточно получить обрамленную диагональную матрицу посредством прибавлений строки к строке и столбца к столбцу (с целыми коэффициентами!) и перестановок строк/столбцов. Более удобно и эффективно действовать даже чуть более общо, посредством домножения на (обрамленные) <span class="math-tex">\(2 \times 2\)</span>-матрицы.</p>

<p>А именно, рассмотрим первый столбец: если он ненулевой, то перестановкой строк можно добиться, чтобы в позиции (1,1) стоял ненулевой элемент, скажем, <span class="math-tex">\(a\)</span>. Если в позиции (2,1) стоит элемент <span class="math-tex">\(b\)</span>, то можно найти (посредством расширенного алгоритма Евклида) такие целые <span class="math-tex">\(x\)</span> и <span class="math-tex">\(y\)</span>, что <span class="math-tex">\(ax+by = d = \gcd(a,b)\)</span>. Но тогда имеет место равенство<span class="math-tex">\[\begin{pmatrix} x &amp; y \\ -b/d &amp; a/d \end{pmatrix} \begin{pmatrix} a \\ b \end{pmatrix} = \begin{pmatrix} d \\ 0 \end{pmatrix} ,\]</span>причем указанная&nbsp;<span class="math-tex">\(2 \times 2\)</span>-матрица обратима над <span class="math-tex">\(\mathbb{Z}\)</span>. Это означает, что домножая матрицу <span class="math-tex">\(A\)</span> на такие <span class="math-tex">\(2 \times 2\)</span>-матрицы (точнее, на матрицы, отличающиеся от единичной только одним <span class="math-tex">\(2 \times 2\)</span>-блоком), можно добиться, чтобы в первом столбце только первый элемент был ненулевым.</p>

<p>Теперь можно то же самое проделать с первой строкой, чтобы в ней только первый элемент был ненулевым. Однако это может сделать ранее обнуленные элементы первого столбца вновь ненулевыми. К счастью, поскольку каждая такая процедура уменьшает количество множителей в каноническом разложении элемента в верхнем левом углу, можно еще раз повторить ее для столбца и строки, покуда в них не останется только один ненулевой элемент.</p>

<p>Когда это сделано, можно повторить эти действия для подматрицы меньшего размера, полученной выбрасыванием первых столбца и строки. Если остающаяся подматрица нулевая, то вычисление закончено, а в противном случае можно получить в ее левом верхнем углу ненулевой элемент посредством перестановок строк и столбцов.</p>

<p>Для СЛУ с целочисленной окаймленной диагональной матрицей разрешимость в целых числах очевидна: для каждого ненулевого элемента столбца правых частей соответствующий диагональный элемент матрицы должен быть его делителем, а соответствующий элемент столбца-решения должен быть равен частному.</p>

<p>Чтобы решить систему линейных уравнений, полезно уметь приводить матрицу не просто к какой-нибудь строчной эшелонированной форме, а к так называемой приведенной строчной эшелонированной форме. Тут в большинстве случаев одними лишь перестановками и прибавлениями строк обойтись не получится, и нужно уметь также домножать строку на множитель.</p>

<p>Напомним, строчная эшелонированная матрица называется приведенной, если каждый ведущий элемент равен 1, а все элементы над ним нулевые.</p>

<p><strong>Совет.</strong> Поскольку метод получения приведенной строчной эшелонированной формы уточняет метод получения какой-нибудь строчной эшелонированной формы, естественно использовать уже имеющиеся наработки, например, так:</p>

<pre><code class="language-python">def ref(self):
    # код для получения строчной эшелонированной формы, записывающий ее в матрицу mat
    return mat

def rref(self):
    mat = self.ref()
    # код для получения приведенной строчной эшелонированной формы на основе mat
    return mat</code></pre>

<p>Однако несколько эффективнее объединить два метода в один, отслеживающий при необходимости позиции ведущих элементов:</p>

<pre><code class="language-python">def ref(self, reduced=False):
    # код, создающий строчную эшелонированную форму в переменной mat
    # и список ведущих элементов в переменной pivots
    if reduced:
        # код, трансформирующий матрицу mat в приведенную строчную
        # эшелонированную форму с использованием ведущих элементов
        # и домножения строк на скаляры
    return mat</code></pre>

<p>Тогда вместо метода <code>rref</code> можно использовать <code>ref(reduced=True)</code>.</p>